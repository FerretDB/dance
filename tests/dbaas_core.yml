---
runner: service

args:
  - mongo/jstests/core/**/*.js

results:
  common:
    ignore:
      - mongo/jstests/core/txns/**/*.js
      # Excluding find_and_modify.js as it tests writability to the config collection, which is N/A for Atlas.
      - mongo/jstests/core/find_and_modify.js
      # Excluding tests requiring admin privs, sharding, a local deployment, or other non-relevance to Atlas
      - mongo/jstests/core/apitest_db.js
      - mongo/jstests/core/apitest_dbcollection.js
      - mongo/jstests/core/basic6.js
      - mongo/jstests/core/batch_write_command_w0.js
      - mongo/jstests/core/check_shard_index.js
      - mongo/jstests/core/collmod_convert_to_ttl.js
      - mongo/jstests/core/count2.js
      - mongo/jstests/core/crud_api.js
      - mongo/jstests/core/datasize2.js
      - mongo/jstests/core/exhaust.js
      - mongo/jstests/core/jssymbol.js
      - mongo/jstests/core/match_numeric_components.js
      - mongo/jstests/core/positional_projection.js
      - mongo/jstests/core/rename_collection_capped.js
      # Tests excluded pre-5.1
      - mongo/jstests/core/add_skip_stage_before_fetch.js
      - mongo/jstests/core/json_schema/bsontype.js
      - mongo/jstests/core/geoc.js
      - mongo/jstests/core/hashed_index_queries.js
      - mongo/jstests/core/index_arr2.js
      - mongo/jstests/core/api_version_parameters.js
      - mongo/jstests/core/api_version_test_expression.js
      - mongo/jstests/core/commands_with_uuid.js
      - mongo/jstests/core/comment_field.js
      - mongo/jstests/core/crud_ops_do_not_throw_locktimeout.js
      - mongo/jstests/core/currentop_cursors.js
      - mongo/jstests/core/currentop_shell.js
      - mongo/jstests/core/currentop_waiting_for_latch.js
      - mongo/jstests/core/disallow_system_views_user_writes.js
      - mongo/jstests/core/failcommand_failpoint.js
      - mongo/jstests/core/fsync.js
      - mongo/jstests/core/hash.js
      - mongo/jstests/core/hidden_index.js
      - mongo/jstests/core/index9.js
      - mongo/jstests/core/index_id_options.js
      - mongo/jstests/core/internal_rename_if_options_and_indexes_match.js
      - mongo/jstests/core/latch_analyzer.js
      - mongo/jstests/core/list_indexes.js
      - mongo/jstests/core/profile_hide_index.js
      - mongo/jstests/core/queryoptimizera.js
      - mongo/jstests/core/read_after_optime.js
      - mongo/jstests/core/roles_info.js
      - mongo/jstests/core/timeseries/timeseries_index_stats.js
      - mongo/jstests/core/validate_db_metadata_command.js
      - mongo/jstests/core/version_api_list_commands_verification.js
      - mongo/jstests/core/version_api_v1_command_coverage.js
      - mongo/jstests/core/views/view_with_invalid_dbname.js
      - mongo/jstests/core/wildcard_index_collation.js
      - mongo/jstests/core/nestedobj1.js
      - mongo/jstests/core/collation.js
      - mongo/jstests/core/computed_projections.js
      - mongo/jstests/core/expr_index_use.js
      - mongo/jstests/core/idhack.js
      - mongo/jstests/core/index_filter_commands.js
      - mongo/jstests/core/indexj.js
      - mongo/jstests/core/objid5.js
      - mongo/jstests/core/plan_cache_sbe.js
      - mongo/jstests/core/projection_dotted_paths.js
      - mongo/jstests/core/projection_expr_mod.js
      - mongo/jstests/core/timeseries/bucket_granularity.js
      - mongo/jstests/core/timeseries/timeseries_delete_concurrent.js
      - mongo/jstests/core/timeseries/timeseries_delete_hint.js
      - mongo/jstests/core/timeseries/timeseries_update_concurrent.js
      - mongo/jstests/core/timeseries/timeseries_update_hint.js
      - mongo/jstests/core/wildcard_index_cached_plans.js
      - mongo/jstests/core/explain_execution_error.js
      - mongo/jstests/core/explain_find.js
      - mongo/jstests/core/sortj.js
      # Post 6.0
      - mongo/jstests/core/batched_multi_deletes.js
      - mongo/jstests/core/clustered_collection_creation.js
      - mongo/jstests/core/collection_uuid_drop.js
      - mongo/jstests/core/collection_uuid_write_commands.js
      - mongo/jstests/core/index_stats.js
      - mongo/jstests/core/list_all_local_sessions.js
      - mongo/jstests/core/timeseries/timeseries_lookup.js
      - mongo/jstests/core/write_change_stream_pit_preimage.js
      - mongo/jstests/core/operation_latency_histogram.js
      - mongo/jstests/core/profile_findandmodify.js
  ferretdb:
    stats:
      expected_fail: 410
      expected_pass: 71
    fail:
      # https://github.com/FerretDB/FerretDB/issues/1492
      - mongo/jstests/core/administrative/auth1.js

      # https://github.com/FerretDB/FerretDB/issues/1750
      - mongo/jstests/core/administrative/auth2.js

      # no such command: 'setParameter' - setLogLevel
      - mongo/jstests/core/administrative/automation_setparameter.js
      - mongo/jstests/core/administrative/list_all_local_sessions.js
      - mongo/jstests/core/administrative/list_all_sessions.js
      - mongo/jstests/core/administrative/set_param1.js

      # no such command: 'rolesInfo'
      - mongo/jstests/core/administrative/builtin_roles_external.js
      # requires_sharding
      - mongo/jstests/core/administrative/check_shard_index.js
      # no such command: 'compact'
      - mongo/jstests/core/administrative/compact_keeps_indexes.js
      # https://github.com/FerretDB/dance/issues/294
      - mongo/jstests/core/administrative/getlog2.js
      # https://github.com/FerretDB/FerretDB/issues/1554
      - mongo/jstests/core/administrative/list_sessions.js
      # no such command: 'validateDBMetadata'
      - mongo/jstests/core/administrative/validate_db_metadata_command.js

      # TODO: create issue BSON field 'batchSize' is the wrong type 'double', expected type 'int'
      - mongo/jstests/core/api/api_params_getmore.js

      # Invalid namespace: createAPIVersion.basicCreate
      - mongo/jstests/core/api/api_version_create.js

      # Invalid namespace: findAndModifyAPIVersion.testColl
      - mongo/jstests/core/api/api_version_find_and_modify.js

      # https://github.com/FerretDB/FerretDB/issues/1413
      - mongo/jstests/core/api/api_version_new_50_language_features.js
      - mongo/jstests/core/api/api_version_new_51_language_features.js

      # https://github.com/FerretDB/FerretDB/issues/2130
      - mongo/jstests/core/api/api_version_new_52_language_features.js

      # Error: command worked when it should have failed
      - mongo/jstests/core/api/api_version_parameters.js
      - mongo/jstests/core/api/api_version_unstable_fields.js

      # https://github.com/FerretDB/FerretDB/issues/1416
      - mongo/jstests/core/api/api_version_pipeline_stages.js

      # https://github.com/FerretDB/FerretDB/issues/1432
      - mongo/jstests/core/api/api_version_test_expression.js

      # Index key value \"text\" is not implemented yet
      - mongo/jstests/core/api/api_version_unstable_indexes.js

      # db.serverStatus().storageEngine is undefined
      - mongo/jstests/core/api/apitest_db.js

      # no such command: 'profile'
      - mongo/jstests/core/api/apitest_db_profile_level.js

      # TODO: investigate - Error: [100] != [-1] are not equal : 11 :
      - mongo/jstests/core/api/apitest_dbcollection.js

      # https://github.com/FerretDB/FerretDB/issues/75
      - mongo/jstests/core/capped/capped.js
      - mongo/jstests/core/capped/capped5.js
      - mongo/jstests/core/capped/capped_empty.js
      # create: support for field \"size\" with value 2.62144e+07 is not implemented yet
      - mongo/jstests/core/capped/capped_large_docs.js
      # value 51200
      - mongo/jstests/core/capped/capped_queries_and_id_index.js
      - mongo/jstests/core/capped/capped_resize.js
      - mongo/jstests/core/capped/capped_update.js
      - mongo/jstests/core/capped/capped_upsert.js

      # TODO: investigate
      - mongo/jstests/core/capped/capped_max1.js
      - mongo/jstests/core/capped/cappeda.js

      # create: support for field \"viewOn\" with value simple is not implemented yet
      - mongo/jstests/core/catalog/list_catalog.js

      # TODO: investigate - Error: ["object"] != ["undefined"] are not equal
      - mongo/jstests/core/catalog/list_collections1.js
  mongodb:
    stats:
      expected_fail: 0
      expected_pass: 481
